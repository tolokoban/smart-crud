{"intl":"","src":"require( 'tfw.wdg.book', function(exports, module) {  \"use strict\";\nvar Hash = require(\"tfw.hash-watcher\");\nvar Widget = require(\"wdg\");\n\n/**\n * @example\n * <div id=\"book-id\">\n *   <div data-page=\"welcome\">...</div>\n *   <div data-page=\"game\">...</div>\n *   <div data-page=\"highscores\">...</div>\n * </div>\n *\n * @example\n * var Book = require(\"tfw.wdg.book\");\n * var book = new Book(\"book-id\");\n * book.show(\"game\");\n * @class Book\n */\nvar Book = function(book, hashPrefix) {\n    if (typeof book === 'string') {\n        book = document.getElementById(book);\n    }\n    Widget.call(this, {element: book});\n    book.$ctrl = this;\n    this.addClass(\"tfw-wdg-book\", \"fullscreen\");\n    var that = this,\n        i, child, id, pages = {}, current, count = 0;\n    for (i = 0 ; i < book.childNodes.length ; i++) {\n        child = book.childNodes[i];\n        if (child.nodeType != 1) continue;\n        child = new Widget({element: child});\n        id = child.attr(\"data-page\");\n        if (id && id.length > 0) {\n            child.addClass(\"page\");\n            if (!child.attr(\"data-index\")) {\n                child.attr(\"data-index\", count);\n            } else {\n                count = parseInt(child.attr(\"data-index\")) || 0;\n            }\n            pages[id] = child;\n            if (!current) {\n                current = child;\n                activate.call( this, child );\n            } else {\n                child.addClass(\"hide\");\n            }\n        } else {\n            child.addClass(\"overlay\");\n        }\n        count++;\n    }\n    this._pages = pages;\n    this._current = current;\n    if (!current) {\n        console.error(\"[tfw.wdg.book] Book without pages!\");\n        console.error(\"[tfw.wdg.book] Pages must have the \\\"data-page\\\" attribute!\");\n    }\n\n    // If hashPrefix has been set, we watch at the hash to change pages.\n    // For instance, if the prefix is \"MyBook\", the hash \"/MyBook/MyPage\"\n    // will switch to the page \"MyPage\" if it exists.\n    if (typeof hashPrefix !== 'undefined') {\n        Hash(function () {\n            var hashes = Hash.hash().split(';');\n            hashes.forEach(function (hash) {\n                hash = hash.trim();\n                var page;\n                if (hash.substr(0, hashPrefix.length + 2) == '/' + hashPrefix + '/') {\n                    page = hash.substr(hashPrefix.length + 2).trim();\n                    that.show(page);\n                }\n            });\n        });\n    }\n};\n\n// Extension of Widget.\nBook.prototype = Object.create(Widget.prototype);\nBook.prototype.constructor = Book;\n\n\n/**\n * @return void\n */\nBook.prototype.show = function(pageID) {\n    var rect;\n    var pages = this._pages;\n    var page = pages[pageID];\n    if( typeof page === 'undefined' ) {\n        console.error( \"[tfw.wdg.book.show] Unknown page `\" + pageID + \"`!\" );\n        return false;\n    }\n    var current = this._current;\n    var pageIdx = parseInt(page.attr(\"data-index\")) || 0;\n    var currentIdx = parseInt(current.attr(\"data-index\")) || 0;\n    if (!page || page == current) return;\n    current.removeClass(\"transition\");\n    current.removeClass(\"right\");\n    current.removeClass(\"hide\");\n    page.removeClass(\"transition\");\n    page.removeClass(\"right\");\n    page.removeClass(\"hide\");\n    if (currentIdx < pageIdx) {\n        page.addClass(\"right\");\n        rect = page.rect();\n        current.addClass(\"hide\");\n        page.removeClass(\"right\");\n    } else {\n        page.addClass(\"hide\");\n        rect = page.rect();\n        current.addClass(\"right\");\n        page.removeClass(\"hide\");\n    }\n    current.addClass(\"transition\");\n    page.addClass(\"transition\");\n    this._current = page;\n\n    activate.call( this, page );\n};\n\n\nfunction activate( page ) {\n    var autofocusable = page.element().querySelector(\"input[autofocus]\");\n    if( autofocusable ) {\n        window.setTimeout( autofocusable.focus.bind( autofocusable ), 300 );\n    }\n    var slotName = page.attr( 'data-activate' );\n    if( slotName ) {\n        var slot = window.APP[slotName];\n        if( typeof slot === 'function' ) {\n            slot( this );\n        }\n    }\n};\n\n\nBook.create = function(book, hashPrefix) {\n    return new Book(book, hashPrefix);\n};\nmodule.exports = Book;\n });\n","zip":"require(\"tfw.wdg.book\",function(t,e){\"use strict\";function a(t){var e=t.element().querySelector(\"input[autofocus]\");e&&window.setTimeout(e.focus.bind(e),300);var a=t.attr(\"data-activate\");if(a){var r=window.APP[a];\"function\"==typeof r&&r(this)}}var r=require(\"tfw.hash-watcher\"),s=require(\"wdg\"),o=function(t,e){\"string\"==typeof t&&(t=document.getElementById(t)),s.call(this,{element:t}),t.$ctrl=this,this.addClass(\"tfw-wdg-book\",\"fullscreen\");var o,i,n,d,l=this,h={},c=0;for(o=0;o<t.childNodes.length;o++)i=t.childNodes[o],1==i.nodeType&&(i=new s({element:i}),n=i.attr(\"data-page\"),n&&n.length>0?(i.addClass(\"page\"),i.attr(\"data-index\")?c=parseInt(i.attr(\"data-index\"))||0:i.attr(\"data-index\",c),h[n]=i,d?i.addClass(\"hide\"):(d=i,a.call(this,i))):i.addClass(\"overlay\"),c++);this._pages=h,this._current=d,d||(console.error(\"[tfw.wdg.book] Book without pages!\"),console.error('[tfw.wdg.book] Pages must have the \"data-page\" attribute!')),\"undefined\"!=typeof e&&r(function(){var t=r.hash().split(\";\");t.forEach(function(t){t=t.trim();var a;t.substr(0,e.length+2)==\"/\"+e+\"/\"&&(a=t.substr(e.length+2).trim(),l.show(a))})})};o.prototype=Object.create(s.prototype),o.prototype.constructor=o,o.prototype.show=function(t){var e,r=this._pages,s=r[t];if(\"undefined\"==typeof s)return console.error(\"[tfw.wdg.book.show] Unknown page `\"+t+\"`!\"),!1;var o=this._current,i=parseInt(s.attr(\"data-index\"))||0,n=parseInt(o.attr(\"data-index\"))||0;s&&s!=o&&(o.removeClass(\"transition\"),o.removeClass(\"right\"),o.removeClass(\"hide\"),s.removeClass(\"transition\"),s.removeClass(\"right\"),s.removeClass(\"hide\"),i>n?(s.addClass(\"right\"),e=s.rect(),o.addClass(\"hide\"),s.removeClass(\"right\")):(s.addClass(\"hide\"),e=s.rect(),o.addClass(\"right\"),s.removeClass(\"hide\")),o.addClass(\"transition\"),s.addClass(\"transition\"),this._current=s,a.call(this,s))},o.create=function(t,e){return new o(t,e)},e.exports=o});\n//# sourceMappingURL=tfw.wdg.book.js.map","map":{"version":3,"file":"tfw.wdg.book.js.map","sources":["tfw.wdg.book.js"],"sourcesContent":["require( 'tfw.wdg.book', function(exports, module) {  \"use strict\";\nvar Hash = require(\"tfw.hash-watcher\");\nvar Widget = require(\"wdg\");\n\n/**\n * @example\n * <div id=\"book-id\">\n *   <div data-page=\"welcome\">...</div>\n *   <div data-page=\"game\">...</div>\n *   <div data-page=\"highscores\">...</div>\n * </div>\n *\n * @example\n * var Book = require(\"tfw.wdg.book\");\n * var book = new Book(\"book-id\");\n * book.show(\"game\");\n * @class Book\n */\nvar Book = function(book, hashPrefix) {\n    if (typeof book === 'string') {\n        book = document.getElementById(book);\n    }\n    Widget.call(this, {element: book});\n    book.$ctrl = this;\n    this.addClass(\"tfw-wdg-book\", \"fullscreen\");\n    var that = this,\n        i, child, id, pages = {}, current, count = 0;\n    for (i = 0 ; i < book.childNodes.length ; i++) {\n        child = book.childNodes[i];\n        if (child.nodeType != 1) continue;\n        child = new Widget({element: child});\n        id = child.attr(\"data-page\");\n        if (id && id.length > 0) {\n            child.addClass(\"page\");\n            if (!child.attr(\"data-index\")) {\n                child.attr(\"data-index\", count);\n            } else {\n                count = parseInt(child.attr(\"data-index\")) || 0;\n            }\n            pages[id] = child;\n            if (!current) {\n                current = child;\n                activate.call( this, child );\n            } else {\n                child.addClass(\"hide\");\n            }\n        } else {\n            child.addClass(\"overlay\");\n        }\n        count++;\n    }\n    this._pages = pages;\n    this._current = current;\n    if (!current) {\n        console.error(\"[tfw.wdg.book] Book without pages!\");\n        console.error(\"[tfw.wdg.book] Pages must have the \\\"data-page\\\" attribute!\");\n    }\n\n    // If hashPrefix has been set, we watch at the hash to change pages.\n    // For instance, if the prefix is \"MyBook\", the hash \"/MyBook/MyPage\"\n    // will switch to the page \"MyPage\" if it exists.\n    if (typeof hashPrefix !== 'undefined') {\n        Hash(function () {\n            var hashes = Hash.hash().split(';');\n            hashes.forEach(function (hash) {\n                hash = hash.trim();\n                var page;\n                if (hash.substr(0, hashPrefix.length + 2) == '/' + hashPrefix + '/') {\n                    page = hash.substr(hashPrefix.length + 2).trim();\n                    that.show(page);\n                }\n            });\n        });\n    }\n};\n\n// Extension of Widget.\nBook.prototype = Object.create(Widget.prototype);\nBook.prototype.constructor = Book;\n\n\n/**\n * @return void\n */\nBook.prototype.show = function(pageID) {\n    var rect;\n    var pages = this._pages;\n    var page = pages[pageID];\n    if( typeof page === 'undefined' ) {\n        console.error( \"[tfw.wdg.book.show] Unknown page `\" + pageID + \"`!\" );\n        return false;\n    }\n    var current = this._current;\n    var pageIdx = parseInt(page.attr(\"data-index\")) || 0;\n    var currentIdx = parseInt(current.attr(\"data-index\")) || 0;\n    if (!page || page == current) return;\n    current.removeClass(\"transition\");\n    current.removeClass(\"right\");\n    current.removeClass(\"hide\");\n    page.removeClass(\"transition\");\n    page.removeClass(\"right\");\n    page.removeClass(\"hide\");\n    if (currentIdx < pageIdx) {\n        page.addClass(\"right\");\n        rect = page.rect();\n        current.addClass(\"hide\");\n        page.removeClass(\"right\");\n    } else {\n        page.addClass(\"hide\");\n        rect = page.rect();\n        current.addClass(\"right\");\n        page.removeClass(\"hide\");\n    }\n    current.addClass(\"transition\");\n    page.addClass(\"transition\");\n    this._current = page;\n\n    activate.call( this, page );\n};\n\n\nfunction activate( page ) {\n    var autofocusable = page.element().querySelector(\"input[autofocus]\");\n    if( autofocusable ) {\n        window.setTimeout( autofocusable.focus.bind( autofocusable ), 300 );\n    }\n    var slotName = page.attr( 'data-activate' );\n    if( slotName ) {\n        var slot = window.APP[slotName];\n        if( typeof slot === 'function' ) {\n            slot( this );\n        }\n    }\n};\n\n\nBook.create = function(book, hashPrefix) {\n    return new Book(book, hashPrefix);\n};\nmodule.exports = Book;\n });\n"],"names":["require","exports","module","activate","page","autofocusable","element","querySelector","window","setTimeout","focus","bind","slotName","attr","slot","APP","this","Hash","Widget","Book","book","hashPrefix","document","getElementById","call","$ctrl","addClass","i","child","id","current","that","pages","count","childNodes","length","nodeType","parseInt","_pages","_current","console","error","hashes","hash","split","forEach","trim","substr","show","prototype","Object","create","constructor","pageID","rect","pageIdx","currentIdx","removeClass"],"mappings":"AAAAA,QAAS,eAAgB,SAASC,EAASC,GAAW,YAyHtD,SAASC,GAAUC,GACf,GAAIC,GAAgBD,EAAKE,UAAUC,cAAc,mBAC7CF,IACAG,OAAOC,WAAYJ,EAAcK,MAAMC,KAAMN,GAAiB,IAElE,IAAIO,GAAWR,EAAKS,KAAM,gBAC1B,IAAID,EAAW,CACX,GAAIE,GAAON,OAAOO,IAAIH,EACF,mBAATE,IACPA,EAAME,OAjIlB,GAAIC,GAAOjB,QAAQ,oBACfkB,EAASlB,QAAQ,OAgBjBmB,EAAO,SAASC,EAAMC,GACF,gBAATD,KACPA,EAAOE,SAASC,eAAeH,IAEnCF,EAAOM,KAAKR,MAAOV,QAASc,IAC5BA,EAAKK,MAAQT,KACbA,KAAKU,SAAS,eAAgB,aAC9B,IACIC,GAAGC,EAAOC,EAAgBC,EAD1BC,EAAOf,KACOgB,KAAqBC,EAAQ,CAC/C,KAAKN,EAAI,EAAIA,EAAIP,EAAKc,WAAWC,OAASR,IACtCC,EAAQR,EAAKc,WAAWP,GACF,GAAlBC,EAAMQ,WACVR,EAAQ,GAAIV,IAAQZ,QAASsB,IAC7BC,EAAKD,EAAMf,KAAK,aACZgB,GAAMA,EAAGM,OAAS,GAClBP,EAAMF,SAAS,QACVE,EAAMf,KAAK,cAGZoB,EAAQI,SAAST,EAAMf,KAAK,gBAAkB,EAF9Ce,EAAMf,KAAK,aAAcoB,GAI7BD,EAAMH,GAAMD,EACPE,EAIDF,EAAMF,SAAS,SAHfI,EAAUF,EACVzB,EAASqB,KAAMR,KAAMY,KAKzBA,EAAMF,SAAS,WAEnBO,IAEJjB,MAAKsB,OAASN,EACdhB,KAAKuB,SAAWT,EACXA,IACDU,QAAQC,MAAM,sCACdD,QAAQC,MAAM,8DAMQ,mBAAfpB,IACPJ,EAAK,WACD,GAAIyB,GAASzB,EAAK0B,OAAOC,MAAM,IAC/BF,GAAOG,QAAQ,SAAUF,GACrBA,EAAOA,EAAKG,MACZ,IAAI1C,EACAuC,GAAKI,OAAO,EAAG1B,EAAWc,OAAS,IAAM,IAAMd,EAAa,MAC5DjB,EAAOuC,EAAKI,OAAO1B,EAAWc,OAAS,GAAGW,OAC1Cf,EAAKiB,KAAK5C,QAQ9Be,GAAK8B,UAAYC,OAAOC,OAAOjC,EAAO+B,WACtC9B,EAAK8B,UAAUG,YAAcjC,EAM7BA,EAAK8B,UAAUD,KAAO,SAASK,GAC3B,GAAIC,GACAtB,EAAQhB,KAAKsB,OACblC,EAAO4B,EAAMqB,EACjB,IAAoB,mBAATjD,GAEP,MADAoC,SAAQC,MAAO,qCAAuCY,EAAS,OACxD,CAEX,IAAIvB,GAAUd,KAAKuB,SACfgB,EAAUlB,SAASjC,EAAKS,KAAK,gBAAkB,EAC/C2C,EAAanB,SAASP,EAAQjB,KAAK,gBAAkB,CACpDT,IAAQA,GAAQ0B,IACrBA,EAAQ2B,YAAY,cACpB3B,EAAQ2B,YAAY,SACpB3B,EAAQ2B,YAAY,QACpBrD,EAAKqD,YAAY,cACjBrD,EAAKqD,YAAY,SACjBrD,EAAKqD,YAAY,QACAF,EAAbC,GACApD,EAAKsB,SAAS,SACd4B,EAAOlD,EAAKkD,OACZxB,EAAQJ,SAAS,QACjBtB,EAAKqD,YAAY,WAEjBrD,EAAKsB,SAAS,QACd4B,EAAOlD,EAAKkD,OACZxB,EAAQJ,SAAS,SACjBtB,EAAKqD,YAAY,SAErB3B,EAAQJ,SAAS,cACjBtB,EAAKsB,SAAS,cACdV,KAAKuB,SAAWnC,EAEhBD,EAASqB,KAAMR,KAAMZ,KAmBzBe,EAAKgC,OAAS,SAAS/B,EAAMC,GACzB,MAAO,IAAIF,GAAKC,EAAMC,IAE1BnB,EAAOD,QAAUkB"},"dependencies":["mod/tfw.wdg.book","mod/tfw.hash-watcher","mod/wdg"]}